---
import Layout from "../layouts/Layout.astro";
import apiData from "../data/api-data";
import { createQuestionUrl, mapApiData } from "../utils/utils";
import type { ApiDataItem, QuestionPageData } from "../store/questions";

export async function getStaticPaths() {
  return mapApiData(apiData as ApiDataItem[]).map((q, index) => {
    const questionPageData: QuestionPageData = {
      ...q,
      slug: createQuestionUrl(q.id),
      category: "b",
      prevSlug: index === 0 ? createQuestionUrl(q.id) : createQuestionUrl(apiData[index - 1].id),
      nextSlug: index === apiData.length - 1 ? createQuestionUrl(q.id) : createQuestionUrl(apiData[index + 1].id),
    };

    return {
      params: { question_slug: questionPageData.slug },
      props: { questionPageData },
    };
  });
}

const { id, text,category, prevSlug, nextSlug } = Astro.props.questionPageData;
---

<Layout>
  <p><a href={prevSlug}>poprzednie</a> | <a href={nextSlug}>nastÄ™pne</a></p>
  <h2>Kategoria: <strong>{category}</strong>, id: {id}</h2>
  <h1>{text}</h1>

  <pre>{JSON.stringify( Astro.params, null,2)}</pre>
  <pre>{JSON.stringify( Astro.props, null,2)}</pre>
</Layout>
